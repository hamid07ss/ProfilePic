<?php/** * Created by PhpStorm. * User: M.Azadi <mohammad.azadi@yahoo.com> * Date: 3/13/2017 * Time: 2:44 PM */$white = '';function ImageLines( $address, $row, $col, $width, $height ) {	global $white;	$canvas = imagecreatefromjpeg( $address );	$white = imagecolorallocate( $canvas, 6, 76, 136 );	imagesetthickness( $canvas, 2 );// parallel line, solid	$parts = 0;	if($row){		$parts = $row;		for ( $i = 0; $i < $parts; $i ++ ) {			imageline( $canvas,				0, ( $height / $parts ) * ( $i + 1 ),				$width, ( $height / $parts ) * ( $i + 1 ),				imagecolorallocate( $canvas, 255, 0, 0 ) ) or die( 'Kunne ikke velge line!' );			$text = $i + 1;			$font = 'BKhodkar.ttf';// Print Text On Image			imagettftext( $canvas, 50, 0, 60, ( $height / $parts ) * ( $i + 1 ) - ( ( $height / $parts ) / 2 ), $white, $font, $text );		}		$img = imagejpeg( $canvas, 'dashes.jpg' );		imagedestroy( $canvas );		return [			'image' => 'http://78.47.129.34/test/dashes.jpg?t=' . strtotime( date( "Y-m-d H:i:s") )		];	}else if($col){		$parts = $col;		$texts = [ 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J' ];		for ( $i = 0; $i < $parts; $i ++ ) {			imageline( $canvas,				( $width / $parts ) * ( $i + 1 ), 0,				( $width / $parts ) * ( $i + 1 ), $height,				imagecolorallocate( $canvas, 255, 0, 0 ) ) or die( 'Kunne ikke velge line!' );			$text = $texts[ $i ];			$font = 'arial.ttf';// Print Text On Image			imagettftext( $canvas, 50, 0, ( $width / $parts ) * ( $i + 1 ) - ( ( $width / $parts ) / 2 ), 90, $white, $font, $text );		}		$img = imagejpeg( $canvas, 'dashes.jpg' );		imagedestroy( $canvas );		return [			'image' => 'http://78.47.129.34/test/dashes.jpg?t=' . strtotime( date( "Y-m-d H:i:s") ),			'texts' => $texts		];	}	return false;}function GenerateImage(	$address, $row, $col, $text, $font, $fontSize, $parts, $width, $height, $persian = true) {	global $white;	$canvas = imagecreatefromjpeg( $address );	$white = imagecolorallocate( $canvas, 6, 76, 136 );	imagesetthickness( $canvas, 2 );	if($persian){		$text = getPersian($text);	}	$textBox = imagettfbbox( $fontSize, 0, $font, $text );	$row_w = (( $width / $parts["col"] ) * ( $col - 1 ));	$row_h = (( $height / $parts["row"] ) * ( $row - 1 ));	$x = (($width / $parts["col"]) - (abs($textBox[4]) - (abs($textBox[6]) * 2))) / 2;	$y = (( $height / $parts["row"] ) - (abs($textBox[7]) - (abs($textBox[1]) * 2))) / 2;	imagettftext( $canvas, $fontSize, 0, $x + $row_w, $y + $row_h, $white, $font, $text );	$img = imagejpeg( $canvas, 'final.jpg' );	imagedestroy( $canvas );	return 'http://78.47.129.34/test/final.jpg?t=' . strtotime( date( "Y-m-d H:i:s") );}function getPersian( $text ) {	require_once "ar-php-master/I18N/Arabic.php";	$Arabic = new I18N_Arabic( 'Glyphs' );	$text   = $Arabic->utf8Glyphs( $text );	return $text;}